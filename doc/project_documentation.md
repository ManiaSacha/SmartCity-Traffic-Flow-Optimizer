# SmartCity Traffic Flow Optimizer - Project Documentation

## 1. Project Overview

The SmartCity Traffic Flow Optimizer is a Python-based project designed to analyze and visualize urban traffic patterns. It leverages OpenStreetMap data to build a road network model, extracts detailed road segment information, and simulates traffic flow based on time of day. The ultimate goal is to provide a platform for understanding and potentially optimizing traffic in smart city environments.

## 2. Key Features

- **Road Network Acquisition**: Downloads drivable street network data for a specified city (e.g., Warsaw, Poland) using OSMnx.
- **Graph Persistence**: Saves the downloaded network graph (GraphML format) to disk for efficient reuse, avoiding repeated downloads.
- **Network Visualization**: Generates and saves visual plots of the road network.
- **Road Segment Extraction**: Converts the network graph into a detailed list of road segments, including coordinates, names, lengths, and unique IDs.
- **Traffic Simulation**: Generates realistic, time-based traffic speed data for each road segment, simulating rush hours, midday traffic, and nighttime free flow.
- **Data Export**: Saves extracted road segments and simulated traffic data to CSV files for analysis and use in other tools.

## 3. Project Structure

```
SmartCity-Traffic-Flow-Optimizer/
├── .gitignore                # Specifies intentionally untracked files that Git should ignore.
├── README.md                 # Main project README with overview and setup instructions.
├── get_map.py                # Script to download/load Warsaw map, visualize, and save graph.
├── extract_segments.py       # Script to load graph, extract road segments, and save to CSV.
├── simulate_traffic.py       # Script to load segments and generate simulated traffic data.
├── warsaw_graph.graphml      # Saved road network graph for Warsaw (GraphML format).
├── warsaw_road_segments.csv  # CSV file containing all extracted road segments.
├── warsaw_named_road_segments.csv # CSV file containing only named road segments.
├── simulated_traffic.csv     # CSV file with simulated hourly traffic speed for each segment.
├── venv/                     # Python virtual environment directory (if created at project root).
└── doc/
    └── project_documentation.md # This file: Detailed project documentation.
```

### File Descriptions:

-   **`get_map.py`**: 
    -   Downloads the drivable road network for Warsaw, Poland, using `osmnx`.
    -   If a local `warsaw_graph.graphml` file exists, it loads the graph from disk to save time.
    -   Saves the downloaded/loaded graph to `warsaw_graph.graphml`.
    -   Generates a plot of the network and saves it as `warsaw_map.png`.
    -   Prints basic network statistics.

-   **`extract_segments.py`**: 
    -   Loads the road network graph from `warsaw_graph.graphml`.
    -   Converts the graph into GeoDataFrames of nodes and edges.
    -   Extracts key information for each road segment (edge): geometry, name (if available), and length.
    -   Calculates start and end coordinates (latitude, longitude) for each segment.
    -   Assigns a unique `segment_id` to each segment.
    -   Saves all segments to `warsaw_road_segments.csv`.
    -   Saves only named segments to `warsaw_named_road_segments.csv` for easier analysis of major roads.

-   **`simulate_traffic.py`**: 
    -   Loads road segments from `warsaw_road_segments.csv`.
    -   For each segment, simulates hourly traffic speed (km/h) for a 24-hour period.
    -   The simulation logic varies speed based on typical traffic patterns: morning/evening rush hours, midday, and nighttime.
    -   Saves the generated time-series traffic data to `simulated_traffic.csv`, including `segment_id`, `road_name`, `hour`, and `speed_kph`.

-   **Data Files (`.graphml`, `.csv`, `.png`)**: These are output files generated by the scripts. They are included in `.gitignore` for `warsaw_graph.graphml` and `*.png` as they can be large and are reproducible.

## 4. Setup and Installation

1.  **Clone the Repository** (if you haven't already):
    ```bash
    git clone https://github.com/ManiaSacha/SmartCity-Traffic-Flow-Optimizer.git
    cd SmartCity-Traffic-Flow-Optimizer
    ```

2.  **Create and Activate a Python Virtual Environment**:
    ```bash
    python -m venv venv
    # On Windows
    .\venv\Scripts\activate
    # On macOS/Linux
    # source venv/bin/activate
    ```

3.  **Install Dependencies**:
    The required packages are `osmnx`, `pandas`, `numpy`, and `matplotlib`.
    ```bash
    pip install osmnx pandas numpy matplotlib
    ```

## 5. Usage

Run the scripts in the following order. Ensure the virtual environment is activated.

1.  **Get the Map and Save the Graph**:
    ```bash
    python get_map.py
    ```
    -   *Output*: `warsaw_graph.graphml`, `warsaw_map.png`.
    -   This step might take some time during the first run as it downloads the map data.

2.  **Extract Road Segments**:
    ```bash
    python extract_segments.py
    ```
    -   *Input*: `warsaw_graph.graphml`.
    -   *Output*: `warsaw_road_segments.csv`, `warsaw_named_road_segments.csv`.

3.  **Simulate Traffic Data**:
    ```bash
    python simulate_traffic.py
    ```
    -   *Input*: `warsaw_road_segments.csv`.
    -   *Output*: `simulated_traffic.csv`.
    -   This script can take several minutes to run due to the large number of segments and hourly data points being generated.

## 6. Generated Data Files

-   **`warsaw_graph.graphml`**: 
    -   An XML-based file format for storing graph data. Contains the entire road network structure (nodes and edges) for Warsaw.
    -   Used by `osmnx` to save and load graphs efficiently.

-   **`warsaw_map.png`**: 
    -   A visual representation of the Warsaw road network.

-   **`warsaw_road_segments.csv`**: 
    -   Columns: `geometry` (LINESTRING WKT), `name` (road name), `length` (meters), `start_lat`, `start_lon`, `end_lat`, `end_lon`, `segment_id`.
    -   Contains data for every road segment in the network.

-   **`warsaw_named_road_segments.csv`**: 
    -   Same columns as `warsaw_road_segments.csv` but filtered to include only segments with a non-null `name`.

-   **`simulated_traffic.csv`**: 
    -   Columns: `segment_id`, `road_name`, `hour` (HH:00 format), `speed_kph` (simulated speed in kilometers per hour).
    -   Provides hourly simulated traffic speed for each segment over a 24-hour period.

## 7. Next Steps and Future Work

-   **Traffic Visualization**: Implement heatmap visualizations of traffic congestion using libraries like Folium or Plotly (Step 4).
-   **Real Traffic Data Integration**: Replace simulated traffic with real-time data from APIs like Google Maps Traffic API or TomTom Traffic API.
-   **Shortest Path Analysis**: Incorporate traffic data into shortest path calculations (e.g., fastest route considering current congestion).
-   **Advanced Simulation**: Enhance the traffic simulation model with more factors (e.g., day of the week, weather, incidents).
-   **API Development**: Create an API to serve traffic information or optimization suggestions.
-   **User Interface**: Develop a web-based UI to interact with the map and traffic data.

This documentation provides a snapshot of the project's current state. It will be updated as the project evolves.
